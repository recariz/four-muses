<% @posts.each do |post| %>
  <div class="card-post">
    <div class="card-post-top-infos">
      <div class="user-avatar-nickname">
        <img class="avatar-small" src="<%= cl_image_path post.user.avatar.key %>" />
        <a href="/users/<%=post.user.id %>"><p>@<%=post.user.nickname.downcase%></p></a>
        <% if (!current_user || !@followings.include?(post.user)) %><a id="post-follow-link"href="#"><p>Follow</p></a>
        <%end  %>
      </div>
      <div class="post-reactions">
        <div class="reaction-type"><p><%= post.likes.count %> </p><a href="#"><i class="fal fa-heart"></i></a></div>
      </div>
    </div>
    <div class="post-content">
      <% if post.photos.count() == 1 %>
        <img class="post-image" src="<%= cl_image_path post.photos.first.key %>" alt="">
      <% else %>
          <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
              <% post.photos.each_with_index do |photo, index| %>
                <li data-target="#carouselExampleIndicators" data-slide-to="<%=index.to_s%>" class ="<%= "active" if index == 0 %>"></li>
              <% end %>
            </ol>
            <div class="carousel-inner" style="">
              <% post.photos.each_with_index do |photo, index| %>
                <div class="carousel-item <%= "active" if index == 0 %>">
                  <img class="d-block post-image" src="<%=photo.service_url %>">
                </div>
              <% end %>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
      <% end %>
      <div class="post-description">
        <h5><%= post.title  %></h5>
        <p><%= post.description %></p>
      </div>
    </div>
    <div class="line-divider"></div>
    <div class="post-comments-container">
        <% post.comments.each do |comment| %>
        <p><span style="font-weight: bolder">@<%= comment.user.nickname %>  </span><%= comment.content %></p>
        <% end %>
        <% if post.comments.count > 1 %>
          <p id="display-comments">See all <%= post.comments.count %> comments...</p>
        <% end %>
        <form class="comment-form" action="">
          <input id="comment-input" type="text" placeholder="Add your comment">
          <input id="comment-submit" type="submit" value="Post">
        </form>
    </div>
  </div>
<% end %>
